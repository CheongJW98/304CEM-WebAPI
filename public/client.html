<html>
    <head>
    	<link rel="icon" href="image/dict.png" type="image/png" sizes="16x16">
        <title>Dictionary</title>
        <link rel="stylesheet" type="text/css" href="external.css">

        <!--bootstrap-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

    </head>
    <body>
    	<div id="wrapper">
    		<div id="header">
            
                <div id="header-cover" class="row">
                <!--
                    <img src="image/bks.jpg" id="dict-header-cover" />
                -->
                    

                    <div id="header-wrapper">
                        <div id="header-container">
                            <img src="image/dict.png" id="dict-header-icon"/>

                            <div class="custom-select">
                                <select name="filter" id="filter-select">
                                    <option value="All">All</option>
                                    <option value="All">All</option>
                                    <option value="Definitions">Definitions</option>
                                    <option value="Synonyms">Synonyms</option>
                                    <option value="Examples">Examples</option>
                                </select>
                            
                            </div>
                            
                            <div class="header-input-container">

                                <input type="text" id="userInput" onkeydown = "if (event.keyCode == 13)
                        document.getElementById('search-button').click()"
                                    placeholder="Type to Search for Words" 
                                    title="Type in a word">

                                <button id="search-button" type="button" onclick="searchWord()">
                                    <img src="image/search-icon-grey.png" id="search-icon" />
                                </button>
                            
                            </div>

                            

                            <!--
                            <select name="filter" id="filter-select">
                                <option value="Definitions">Definitions</option>
                                <option value="Synonyms">Synonyms</option>
                                <option value="Tags">Tags</option>
                            </select>
                            -->
                        </div>
                    </div>

                </div>
            
                


    		</div>

            <div id="result-container">
                <div id="page-title-container">
                    <p class="page-title">Search Results for:</p>
                    <p class="word-searched" id="word-searched">Example</p>
                </div>
                
                <div id="search-result-container" class="row">
                    

                </div>
            </div>

            <div id="welcome-container">
                <p id="welcome-text">Welcome to Dicts</p>
            </div>


            <div class="modal fade" id="showWord" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal Content-->
                    <div class="modal-content">
                        <!--Modal Header-->
                        <div class="modal-header">
                            <button type="button" id="showModalClose" class="close" data-dismiss="modal">&times;</button>
                            <h3 class="modal-title" id="show-modal-title"></h3><!--set title in function-->
                        </div>
                        <div class="modal-body">
                            <div class= "content wrapper">
                                <div class="form-group" >
                                    <table class="show-word-details-table" id="show-word-details-table">
                                        
                                    </table>
                                </div>
                            </div>
                            <div class="modal-footer" style="margin-bottom: -20px;">
                                <div class="row">
                                    <div class="col-xs-10"></div>
                                    <div class="col-xs-2">
                                        <div class="form-group">
                                            <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>            
                        
                    </div>
                </div>
            </div>

    	</div>
        

        


        <script>

            //function to show only information filtered by user
            function checkSelectedOptions(){
                var filterOption = document.getElementsByClassName('select-selected')[0].innerHTML
                console.log(filterOption)
                if(filterOption === 'All'){
                    $('.clientOriginShow').show()
                    $('.clientDefiShow').show()
                    $('.clientSynonymShow').show()
                    $('.clientAntonymShow').show()
                    $('.clientCrossReferenceShow').show()
                    $('.clientHypernymShow').show()
                    $('.clientSameContextShow').show()
                    $('.clientExampleShow').show()
                }
                else if(filterOption === "Definitions"){
                    $('.clientOriginShow').hide()
                    $('.clientDefiShow').show()
                    $('.clientSynonymShow').hide()
                    $('.clientAntonymShow').hide()
                    $('.clientCrossReferenceShow').hide()
                    $('.clientHypernymShow').hide()
                    $('.clientSameContextShow').hide()
                    $('.clientExampleShow').hide()
                }
                else if(filterOption === "Synonyms"){
                    $('.clientOriginShow').hide()
                    $('.clientDefiShow').hide()
                    $('.clientSynonymShow').show()
                    $('.clientAntonymShow').hide()
                    $('.clientCrossReferenceShow').hide()
                    $('.clientHypernymShow').hide()
                    $('.clientSameContextShow').hide()
                    $('.clientExampleShow').hide()
                }
                else if(filterOption === "Examples"){
                    $('.clientOriginShow').hide()
                    $('.clientDefiShow').hide()
                    $('.clientSynonymShow').hide()
                    $('.clientAntonymShow').hide()
                    $('.clientCrossReferenceShow').hide()
                    $('.clientHypernymShow').hide()
                    $('.clientSameContextShow').hide()
                    $('.clientExampleShow').show()
                }
            }


            //javascript codes for drop down list

            var x, i, j, selElmnt, a, b, c;
            /*look for any elements with the class "custom-select":*/
            x = document.getElementsByClassName("custom-select");
            for (i = 0; i < x.length; i++) {
            selElmnt = x[i].getElementsByTagName("select")[0];
            /*for each element, create a new DIV that will act as the selected item:*/
            a = document.createElement("DIV");
            a.setAttribute("class", "select-selected");
            a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
            x[i].appendChild(a);
            /*for each element, create a new DIV that will contain the option list:*/
            b = document.createElement("DIV");
            b.setAttribute("class", "select-items select-hide");
            for (j = 1; j < selElmnt.length; j++) {
                /*for each option in the original select element,
                create a new DIV that will act as an option item:*/
                c = document.createElement("DIV");
                c.innerHTML = selElmnt.options[j].innerHTML;
                c.addEventListener("click", function(e) {
                    /*when an item is clicked, update the original select box,
                    and the selected item:*/
                    var y, i, k, s, h;
                    s = this.parentNode.parentNode.getElementsByTagName("select")[0];
                    h = this.parentNode.previousSibling;
                    for (i = 0; i < s.length; i++) {
                    if (s.options[i].innerHTML == this.innerHTML) {
                        s.selectedIndex = i;
                        h.innerHTML = this.innerHTML;
                        y = this.parentNode.getElementsByClassName("same-as-selected");
                        for (k = 0; k < y.length; k++) {
                        y[k].removeAttribute("class");
                        }
                        this.setAttribute("class", "same-as-selected");
                        break;
                    }
                    }
                    h.click();
                });
                b.appendChild(c);
            }
            x[i].appendChild(b);
            a.addEventListener("click", function(e) {
                /*when the select box is clicked, close any other select boxes,
                and open/close the current select box:*/
                e.stopPropagation();
                closeAllSelect(this);
                this.nextSibling.classList.toggle("select-hide");
                this.classList.toggle("select-arrow-active");
                });
            }
            function closeAllSelect(elmnt) {
            /*a function that will close all select boxes in the document,
            except the current select box:*/
            var x, y, i, arrNo = [];
            x = document.getElementsByClassName("select-items");
            y = document.getElementsByClassName("select-selected");
            for (i = 0; i < y.length; i++) {
                if (elmnt == y[i]) {
                arrNo.push(i)
                } else {
                y[i].classList.remove("select-arrow-active");
                }
            }
            for (i = 0; i < x.length; i++) {
                if (arrNo.indexOf(i)) {
                x[i].classList.add("select-hide");
                }
            }
            }
            /*if the user clicks anywhere outside the select box,
            then close all select boxes:*/
            document.addEventListener("click", closeAllSelect);


            // end of javascript code for drop down list

            //search word function, get all word that matches the input string, no matter where it locates in word
            function searchWord(){

				let input = $('#userInput').val();

				if (input.length !=0){
                    
                    $('#result-container').show();
                    $('#welcome-container').hide();
                    
                    document.getElementById('word-searched').innerHTML = input;

                    url = `https://dict-api-304cem.herokuapp.com/searchWord/` + input;

                    fetch(url)
                    .then(resp => {
                        return resp.json();
                    })
                    .then(jsonResp => {
                        result = jsonResp;

                        currentWord = result[0]

                        console.log(result.length)
                    
                        let content = document.getElementById('search-result-container');
                        //Clear display area
                        content.innerHTML = ''; 
                        let info = '';

                        //if no results found, display message
                        //else if there is only one result, show related fields and information for the word
                        //else, if there are more than one result, show all related words to user

                        if(result.length ===0){
                            info+= 'No result found. '
                        }
                        else if (result.length === 1){

                            info+= `<div>`
                            info+= `<span class="clientWordDetailsTitle" >${currentWord['word']} </span><br><br>`
                            info+= `</div>`  

                            info+= `<div class="clientOriginShow">`
                            info+= `<span class="clientWordDetailsTitle" >Origin: </span><br>`
                            info+= `<span class="clientShowDetailsSentence" >${currentWord['origin']}</span>`
                            info+= `</div>`        

                            var defiArr = currentWord['definition']
                            var defiNumArr = currentWord['defiTypeNum']
                            var defiTypeArr = currentWord['defiTypeName']

                            var temp = 0;

                            for (x in defiNumArr){
                                var defiCount = defiNumArr[x]
                                for (let i=0; i<defiCount; i++){
                                    if(temp === 0){
                                        info+= `<div class="clientDefiShow">`
                                        info+= `<span class="clientWordDetailsTitle" > Definition:<br/>${defiTypeArr[x]}</span><br>`
                                        info+= `<span class="clientShowDetailsSentence" >${i+1}. ${defiArr[temp]}</span>`
                                        info+= `</div>`
                                    }
                                    else if(i === 0 && temp !== 0){
                                        //console.log('second else')
                                        info+= `<div class="clientDefiShow">`
                                        info+= `<span class="clientWordDetailsTitle" >${defiTypeArr[x]}</span><br>`
                                        info+= `<span class="clientShowDetailsSentence" >${i+1}. ${defiArr[temp]}</span>`
                                        info+= `</div>`
                                    }
                                    else{
                                        //console.log('third else')
                                        info+= `<div class="clientDefiShow">`
                                        info+= `<span class="clientShowDetailsSentence" >${i+1}. ${defiArr[temp]}</span>`
                                        info+= `</div>`
                                    }//${temp}
                                    ++temp;
                                }
                                
                            
                            }

                            for (let i = 0 ; i < currentWord['synonym'].length; i++){
                                if(i == 0){
                                    info+= `<div class="clientSynonymShow">`
                                    info+= `<span class="clientWordDetailsTitle" >Synonym: </span><br>`
                                    info+= `</div>`
                                    info+= `<div class="clientSynonymShow">`
                                    info+= `<span class="clientShowDetailsText" >${currentWord['synonym'][i]}</span>`
                                }
                                else{
                                    info+= `<span class="clientShowDetailsText" >${currentWord['synonym'][i]}</span>`
                                }
                                if(i===(currentWord['synonym'].length-1)){
                                    info+= `</div>`
                                }
                            }

                            for (let i = 0 ; i < currentWord['antonym'].length; i++){
                                if(i==0){
                                    info+= `<div class="clientAntonymShow">`
                                    info+= `<span class="clientWordDetailsTitle" >Antonym: </span><br>`
                                    info+= `</div>`
                                    info+= `<div class="clientAntonymShow">`
                                    info+= `<span class="clientShowDetailsText" >${currentWord['antonym'][i]}</span>`
                                }
                                else{
                                    info+= `<span class="clientShowDetailsText" >${currentWord['antonym'][i]}</span>`
                                }
                                if(i===(currentWord['antonym'].length-1)){
                                    info+= `</div>`
                                }
                            }

                            for (let i = 0 ; i < currentWord['crossReference'].length; i++){
                                if(i==0){
                                    info+= `<div class="clientCrossReferenceShow">`
                                    info+= `<span class="clientWordDetailsTitle" >Cross Reference:</span><br>`
                                    info+= `</div>`
                                    info+= `<div class="clientCrossReferenceShow">`
                                    info+= `<span  class="clientShowDetailsText" >${currentWord['crossReference'][i]}</span>`
                                }
                                else{
                                    info+= `<span class="clientShowDetailsText" >${currentWord['crossReference'][i]}</span>`
                                }
                                if(i===(currentWord['crossReference'].length-1)){
                                    info+= `</div>`
                                }
                            }

                            for (let i = 0 ; i < currentWord['hypernym'].length; i++){
                                if(i==0){
                                    info+= `<div class="clientHypernymShow">`
                                    info+= `<span class="clientWordDetailsTitle" >Hypernym</span><br>`
                                    info+= `</div>`
                                    info+= `<div class="clientHypernymShow">`
                                    info+= `<span class="clientShowDetailsText" >${currentWord['hypernym'][i]}</span>`
                                }
                                else{
                                    info+= `<span  class="clientShowDetailsText" >${currentWord['hypernym'][i]}</span>`
                                }
                                if(i===(currentWord['hypernym'].length-1)){
                                    info+= `</div>`
                                }
                            }

                            for (let i = 0 ; i < currentWord['sameContext'].length; i++){
                                if (i==0){
                                    info+= `<div class="clientSameContextShow">`
                                    info+= `<span class="clientWordDetailsTitle" >Same Context:</span><br>`
                                    info+= `</div>`
                                    info+= `<div class="clientSameContextShow">`
                                    info+= `<span class="clientShowDetailsText" >${currentWord['sameContext'][i]}</span>`
                                }
                                else{
                                    info+= `<span class="clientShowDetailsText" >${currentWord['sameContext'][i]}</span>`
                                }
                                if(i===(currentWord['sameContext'].length-1)){
                                    info+= `</div>`
                                }

                            }

                            for (let i = 0 ; i < currentWord['example'].length; i++){
                                if (i==0){
                                    info+= `<div class="clientExampleShow">`
                                    info+= `<span class="clientWordDetailsTitle" >Examples</span><br>`
                                    info+= `<span class="clientShowDetailsSentence" >${i+1}. ${currentWord['example'][i]}</div>`
                                    info+= `</div>`
                                }
                                else{
                                    info+= `<div class="clientExampleShow">`
                                    info+= `<span class="clientShowDetailsSentence" >${i+1}. ${currentWord['example'][i]}</span>`
                                    info+= `</div>`
                                }
                            }


                        }
                        else{

                            for (let i = 1; i <= result.length; i += 1) {
                                const word = result[i-1];
                                info+= `<div class="col-xs-2 client-card-result"><button class="client-card-btn" onClick = "showWordDetails('${word['_id']}')" data-toggle="modal" data-target="#showWord">`+ word['word'] +`</button></div>`;

                            }

                        }

                        content.innerHTML = info;
                        checkSelectedOptions();

                    });
                }
				else if (input.length ==0){
                    $('#result-container').hide();
                    $('#welcome-container').show();

				}
            }

            //function to fetch single word details from database
            function showWordDetails(id){

                url = 'https://dict-api-304cem.herokuapp.com/fetchWord/' + id

                fetch(url)
                .then(resp => {
                    return resp.json();
                })
                .then(jsondata => {
                    result = jsondata;

                    const currentWord = result

                    document.getElementById("show-modal-title").innerHTML = currentWord['word'];

                    let content = document.getElementById('show-word-details-table');
                    //Clear display area
                    content.innerHTML = ''; 
                    let info = '';

                    info+= `<tr class="clientOriginShow">`
                    info+= `<td class="col-xs-2"> <span>Origin: </span></td>`
                    info+= `<td class="col-xs-10"><textarea class="form-control originInput" row="3"id="originInput" readonly>${currentWord['origin']}</textarea></td>`
                    info+= `<tr>`        

                    var defiArr = currentWord['definition']
                    var defiNumArr = currentWord['defiTypeNum']
                    var defiTypeArr = currentWord['defiTypeName']

                    var temp = 0;

                    for (x in defiNumArr){
                        var defiCount = defiNumArr[x]
                        for (let i=0; i<defiCount; i++){
                            if(temp === 0){
                                info+= `<tr class="clientDefiShow">`
                                info+= `<td class="col-xs-2"> <span>Definition:<br/>${defiTypeArr[x]}</span></td>`
                                info+= `<td class="col-xs-10"><textarea class="form-control wordDefi" row="2" readonly>${defiArr[temp]}</textarea></td>`
                                info+= `<tr>`
                            }
                            else if(i === 0 && temp !== 0){
                                //console.log('second else')
                                info+= `<tr class="clientDefiShow">`
                                info+= `<td class="col-xs-2"><span>${defiTypeArr[x]}</span></td>`
                                info+= `<td class="col-xs-10"><textarea class="form-control wordDefi" row="2" readonly>${defiArr[temp]}</textarea></td>`
                                info+= `<tr>`
                            }
                            else{
                                //console.log('third else')
                                info+= `<tr class="clientDefiShow">`
                                info+= `<td class="col-xs-2"></td>`
                                info+= `<td class="col-xs-10"><textarea class="form-control wordDefi" row="2" readonly>${defiArr[temp]}</textarea></td>`
                                info+= `<tr>`
                            }//${temp}
                            ++temp;
                        }
                        
                    
                    }

                    for (let i = 0 ; i < currentWord['synonym'].length; i++){
                        if(i == 0){
                            info+= `<tr class="clientSynonymShow">`
                            info+= `<td class="col-xs-2"><span>Synonym: </span></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordSyno" row="1" readonly>${currentWord['synonym'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                        else{
                            info+= `<tr class="clientSynonymShow">`
                            info+= `<td class="col-xs-2"></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordSyno" row="1" readonly>${currentWord['synonym'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                    }

                    for (let i = 0 ; i < currentWord['antonym'].length; i++){
                        if(i==0){
                            info+= `<tr class="clientAntonymShow">`
                            info+= `<td class="col-xs-2"><span>Antonym: </span></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordAnto" row="1" readonly>${currentWord['antonym'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                        else{
                            info+= `<tr class="clientAntonymShow">`
                            info+= `<td class="col-xs-2"></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordAnto" row="1" readonly>${currentWord['antonym'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                    }

                    for (let i = 0 ; i < currentWord['crossReference'].length; i++){
                        if(i==0){
                            info+= `<tr class="clientCrossReferenceShow">`
                            info+= `<td class="col-xs-2"><span>Cross Reference:</span></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordCR" row="1" readonly>${currentWord['crossReference'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                        else{
                            info+= `<tr class="clientCrossReferenceShow">`
                            info+= `<td class="col-xs-2"></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordCR" row="1" readonly>${currentWord['crossReference'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                    }

                    for (let i = 0 ; i < currentWord['hypernym'].length; i++){
                        if(i==0){
                            info+= `<tr class="clientHypernymShow">`
                            info+= `<td class="col-xs-2"><span>Hypernym</span></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordHypernym" row="1" readonly>${currentWord['hypernym'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                        else{
                            info+= `<tr class="clientHypernymShow">`
                            info+= `<td class="col-xs-2"></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordHypernym" row="1" readonly>${currentWord['hypernym'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                    }

                    for (let i = 0 ; i < currentWord['sameContext'].length; i++){
                        if (i==0){
                            info+= `<tr class="clientSameContextShow">`
                            info+= `<td class="col-xs-2"><span>Same Context:</span></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordSameContext" row="1" readonly>${currentWord['sameContext'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                        else{
                            info+= `<tr class="clientSameContextShow">`
                            info+= `<td class="col-xs-2"></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordSameContext" row="1" readonly>${currentWord['sameContext'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                    }

                    for (let i = 0 ; i < currentWord['example'].length; i++){
                        if (i==0){
                            info+= `<tr class="clientExampleShow">`
                            info+= `<td class="col-xs-2"><span>Examples</span></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordExample" row="3" readonly>${currentWord['example'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                        else{
                            info+= `<tr class="clientExampleShow">`
                            info+= `<td class="col-xs-2"></td>`
                            info+= `<td class="col-xs-10"><textarea class="form-control wordExample" row="3" readonly>${currentWord['example'][i]}</textarea></td>`
                            info+= `<tr>`
                        }
                    }

                    content.innerHTML = info;
                    checkSelectedOptions();

                });
            }

            


        </script>

    </body>
</html>